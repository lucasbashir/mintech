
{% load custom_tags %}
{% load my_filters %}
{% load static %}


<ul class="list-group">
    {% for comment in posts.postComment.all|slice:":3" %}
      <li class="list-group-item">
        {% if comment.author.profile_pics %}
        <a href="{% url 'profile' user_id=comment.author.id %}">
          <img src="{{ comment.author.profile_pics.url }}" class="rounded-circle" width="70" height="70">
        </a>
        {% else %}
        <a href="{% url 'profile' user_id=comment.author.id %}">
          <img src="/media/post_image/hand.gif" class="rounded-circle" width="70" height="70">
        </a>
        {% endif %}
        <strong><a href="{% url 'profile' user_id=comment.author.id %}">@{{ comment.author.username }}</a> wrote:</strong>
        <div class="card-text" id="content_{{ comment.id }}">
          {% for paragraph in comment.message|split_paragraphs|slice:":8" %}
            <p>{{ paragraph|urlize }}</p>
          {% endfor %}
          {% if comment.message|split_paragraphs|length > 5 %}
          <a href="{% url 'post_content' post_id=posts.id %}">
            <p class="btn btn-link read-more" data-post="{{ posts.id }}">Read full comment >>></p>
          </a>
          {% endif %}
        </div>
      </li>
    {% empty %}
      <li class="list-group-item">No comments yet.</li>
    {% endfor %}
    {% if posts.postComment.all|length > 3 %}
    <li class="list-group-item">
      <a href="{% url 'post_content' post_id=posts.id %}">
      <p class="btn btn-link read-more" data-post="{{ posts.id }}">Read more comments >>></p>
    </a>
    </li>
  {% endif %}
  </ul>
  <br>
        {% if user.is_authenticated %}
        <form action="{% url 'addComment' post_id=posts.id %}" method="POST">
          {% csrf_token %}
          <div class="form-group">
            <span class="comment-field">
            <textarea type="text" id="new-comment" name="newComment" class="form-control rounded-0 shadow-none" rows="3" placeholder="Write a comment..."></textarea>
          </span>
          </div>
          <div class="form-group">
            <span class="btn-comment">
            <button type="submit" class="btn btn-primary btn-sm" style="background-color: #1877f2; border-color: #1877f2;" id="comment-btn">
              <i class="fas fa-paper-plane"></i> Comment
            </button>
          </span>
          </div>
        </form>
        {% endif %}